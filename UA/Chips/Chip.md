# Chip (Базовий Чіп)

[← На Головну](../Main.md)

Базовий клас `Chip` є візуальним представленням та компонентом взаємодії для об'єктів на ігровому полі. Він відповідає за відображення стану, ефектів та обробку Unity подій (Input).

Сама логіка злиття (Merge) та переміщення винесена у відповідні логічні класи.

## Архітектура та Відповідальність

### 1. `Chip.cs` (Базовий Клас)
Клас `Chip` є візуальним представленням та базовим компонентом.
- **Властивості (Data)**: Зберігає посилання на `ChipData`.
  - **Type**: Ідентифікатор типу фішки (string).
  - **MergeData**: Інформація про наступну фішку при злитті.
  - **Size**: Розмір фішки в клітинках (Vector2Int).
  - **CellPosition**: Поточна позиція фішки на сітці поля (Vector2Int).
- **Ефекти**: Керує візуальними ефектами, такими як:
  - `MergeAvailableEffect`: Підсвітка при можливості злиття.
  - `CellHighlightEffect`: Підсвітка клітинки під фішкою.
- **Анімація**: Має посилання на `Animator` для відтворення станів (наприклад, `Merge`).

### 2. `MergeableChipLogic.cs` (Логіка Злиття)
Вся логіка об'єднання фішок реалізована в цьому класі.
- **Перевірка (`CanInteract`)**:
  - Порівнює `ChipData` двох фішок.
  - Перевіряє наявність та активність `MergeData`.
  - Визначає, чи можливе створення `NextChip`.
- **Виконання (`ExecuteInteraction`)**:
  - Обробляє ситуації, коли нова фішка більша за попередні (зсув сусідніх фішок).
  - Знищує старі фішки (`Destroy`).
  - Створює нову фішку через `ChipFactory`.
  - Запускає анімацію злиття.

### 3. `DraggableChipLogic.cs` (Input)
Обробляє Input гравця (Drag-and-Drop). Використовує `MergeableChipLogic` для перевірки дій гравця.

## Процес Злиття (Flow)

1. **Input**: Гравець перетягує фішку (`DraggableChipLogic`).
2. **Move**: При переміщенні над іншою фішкою викликається `CanInteract` з `MergeableChipLogic`.
3. **Feedback**: Якщо `CanInteract` = true, на нижній фішці активується ефект (`Chip.MergeAvailableEffect`).
4. **Drop**: При відпусканні фішки викликається `ExecuteInteraction`.
5. **Result**: Старі фішки зникають, з'являється нова, анімація відіграється на новому об'єкті.
